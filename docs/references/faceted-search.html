<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  Copyright © 2013-2020 Metreeca srl. All rights reserved.

  This file is part of Metreeca/Link.

  Metreeca/Link is free software: you can redistribute it and/or modify it under the terms
  of the GNU Affero General Public License as published by the Free Software Foundation,
  either version 3 of the License, or(at your option) any later version.

  Metreeca/Link is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  See the GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License along with Metreeca/Link.
  If not, see <http://www.gnu.org/licenses/>.
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->

<!DOCTYPE html>
<html lang="en">
	<head><title>REST Faceted API Search Reference | Metreeca Linked Data Framework</title>
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<link rel="shortcut icon" href="../index.svg">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/themes/prism.min.css">
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/components/prism-core.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/plugins/autoloader/prism-autoloader.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../index.css">
	</head>
	<body><input id="toggle" type="checkbox">
		<nav>
			<header>
				<span><a href="https://www.metreeca.com/">metreeca</a><a href="../index.html">link<span>v0.53.0</span></a></span><label for="toggle"></label>
			</header>
			<section><a class="title" onclick="document.querySelector('main').scrollTo(0, 0)">REST Faceted API Search
				Reference</a><h1><a href="#queries">Queries</a></h1><h2><a href="#items-query">Items Query</a></h2><h2>
				<a href="#terms-query">Terms Query</a></h2><h2><a href="#stats-query">Stats Query</a></h2><h1>
				<a href="#extended-json">Extended JSON</a></h1><h2><a href="#facet-filters">Facet Filters</a></h2><h2>
				<a href="#property-paths">Property Paths</a></h2></section>
		</nav>
		<main>
			<header>REST Faceted API Search Reference</header>
			<section><p>REST APIs publishing model-driven <a href="https://www.w3.org/TR/ldp/#ldpc" target="_blank">LDP
				Containers</a> support engine-managed faceted search capabilities, driven by structural and typing
				constraints specified in the underlying linked data model.</p>
				<!-- document support for other query serializations -->
				<p>Faceted searches return an RDF description of the query-specific result set. Standard content
					negotiation is supported for the RDF payload through the <code>Accept</code> HTTP request header. In
					the following sections, RDF structures for query responses are outlined using the
					<a href="idiomatic-json">idiomatic JSON</a> format (<code>application/json</code> MIME type).</p>
				<h1 id="queries">Queries</h1>
				<p>Linked data <a href="../javadocs/com/metreeca/tree/Query.html">queries</a> define what kind of results
					is expected from faceted searches on
					<a href="../tutorials/interacting-with-ldp-apis#read-operations">readable</a> linked data REST APIs.
				</p>
				<p>JSON query serialization extends the <a href="idiomatic-json">idiomatic JSON</a> format with
					query-specific objects for serializing facet <a href="#facet-filters">filters</a> and property
					<a href="#property-paths">paths</a>. Standard JSON serialization applies to all RDF terms appearing
					in filters, including <a href="idiomatic-json#literals">shorthands</a> for numeric values and
					literals with provable datatypes.</p>
				<p class="warning">Work in progress… specs to be improved and detailed.</p>
				JSON-based queries are appended to container IRIs using one of the following encodings:
				<ul>
					<li>
						<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURI" target="_blank">URLEncoded</a>
						(e.g. <code>&quot;http://example.com/container/?&quot;+encodeURI({ &lt;query&gt; })</code>)
					</li>
					<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams" target="_blank">URLSearchParams</a>
						(e.g. <code>&quot;http://example.com/container/?&quot;+new URLSearchParams({ &lt;query&gt;
							})</code>)
					</li>
				</ul>
				<p>The second form supports idiomatic collection filtering (e.g. <code>http://example.com/container/?&lt;property&gt;=&lt;value&gt;&amp;…</code>,
					but requires:</p>
				<ul>
					<li>values to contain no comma;</li>
					<li>boolean, numeric and other literal properties to be specified as such in the driving shape.</li>
				</ul>
				<h2 id="items-query">Items Query</h2>
				<p><a href="../javadocs/com/metreeca/tree/queries/Items.html">Items</a> queries return the RDF
					description of container items matching a set of facet filters.</p>
				<pre><code>&lt;items query&gt; ::= { // all fields are optional and nullable

    &quot;&lt;filter&gt;&quot;: &lt;term&gt; | [&lt;term&gt;, …],
    
    ⋮
    
    &quot;_order&quot;: &lt;criterion&gt; | [&lt;criterion&gt;,(&lt;criterion&gt;)*],
    &quot;_offset&quot;: &lt;integer&gt;,
    &quot;_limit&quot;: &lt;integer&gt;
    
}

&lt;criterion&gt; :;= &quot;[-+]?&lt;path&gt;&quot;
</code></pre>
				<pre><code>&lt;items response&gt; ::= {
    &quot;@id&quot;: &quot;&lt;target-iri&gt;&quot;
    &quot;contains&quot;: [&lt;term&gt;(, &lt;term&gt;)*]
}
</code></pre>
				<h2 id="terms-query">Terms Query</h2>
				<p><a href="../javadocs/com/metreeca/tree/queries/Terms.html">Terms</a> queries return an RDF report
					detailing option values and counts for a facet specified by a target property path, taking into
					account applied filters.</p>
				<pre><code>&lt;terms query&gt; ::= {
        
    &quot;&lt;filter&gt;&quot;: &lt;term&gt; | [&lt;term&gt;, …],  // optional and nullable
    
    ⋮

    &quot;_terms&quot;: &quot;&lt;path&gt;&quot;

}
</code></pre>
				<pre><code>&lt;terms response&gt; ::= {

    &quot;@id&quot;: &quot;&lt;target-iri&gt;&quot;
        
    &quot;terms&quot;: [ // sorted by descending count
        {
            &quot;value&quot;: { &quot;@id&quot;: &lt;iri&gt;[, &quot;label&quot;: &quot;&lt;label&gt;&quot;]} | &lt;literal&gt;,
            &quot;count&quot;: &lt;number&gt;
        }
    ]
}
</code></pre>
				<h2 id="stats-query">Stats Query</h2>
				<p><a href="../javadocs/com/metreeca/tree/queries/Stats.html">Stats</a> queries return an RDF report
					detailing datatype, count and range stats for a facet specified by a target property path, taking
					into account applied filters.</p>
				<pre><code>&lt;stats query&gt; ::= {
    
    &quot;&lt;filter&gt;&quot;: &lt;term&gt; | [&lt;term&gt;, …],  // optional and nullable
    
    ⋮

    &quot;_stats&quot;: &quot;&lt;path&gt;&quot;
    
}
</code></pre>
				<pre><code>&lt;stats response&gt; ::= {

    &quot;@id&quot;: &quot;&lt;target-iri&gt;&quot;
    
    // global stats 
    
    &quot;count&quot;: &lt;number&gt;,
    &quot;min&quot;: &lt;term&gt;,
    &quot;max&quot;: &lt;term&gt;,
    
    // datatype-specific stats sorted by descending count
    
    &quot;stats&quot;: [
        {
            &quot;@id&quot;: &quot;&lt;datatype-iri&gt;&quot;,
            &quot;count&quot;: &lt;number&gt;,
            &quot;min&quot;: &lt;term&gt;,
            &quot;max&quot;: &lt;term&gt;
        }
    ]
}
</code></pre>
				<h1 id="extended-json">Extended JSON</h1>
				<h2 id="facet-filters">Facet Filters</h2>
				<pre><code>&lt;filter&gt; ::= {

    &quot;^ &lt;path&gt;&quot;: &quot;&lt;datatype&gt;&quot;, // datatype
    &quot;@ &lt;path&gt;&quot;: &quot;&lt;class&gt;&quot;, // class
    
    &quot;&gt; &lt;path&gt;&quot;: &lt;term&gt;, // minExclusive
    &quot;&lt; &lt;path&gt;: &lt;term&gt;, // maxExclusive
    &quot;&gt;= &lt;path&gt;&quot;: &lt;term&gt;, // minInclusive
    &quot;&lt;= &lt;path&gt;&quot;: &lt;term&gt;, // maxInclusive
    
    &quot;$&gt; &lt;path&gt;&quot;: &lt;term&gt;, // minLength
    &quot;$&lt; &lt;path&gt;&quot;: &lt;term&gt;, // maxLength
    
    &quot;* &lt;path&gt;&quot;: &quot;pattern&quot;, // pattern (regular expression matching)
    &quot;~ &lt;path&gt;&quot;: &quot;keywords&quot;, // like (stemmed word search)
    
    &quot;#&gt; &lt;path&gt;&quot;: &lt;integer&gt;, // minCount
    &quot;#&lt; &lt;path&gt;&quot;: &lt;integer&gt;, // maxCount
    
    &quot;% &lt;path&gt;&quot;: &lt;term&gt; | [&lt;term&gt;(, &lt;term&gt;)*], // in
    &quot;! &lt;path&gt;&quot;: &lt;term&gt; | [&lt;term&gt;(, &lt;term&gt;)*], // all
    &quot;? &lt;path&gt;&quot;: &lt;term&gt; | [&lt;term&gt;(, &lt;term&gt;)*], // any
        
    &quot;&lt;path&gt;&quot;: &lt;term&gt;, //  shorthand for &quot;? &lt;path&quot;: &lt;term&gt;
    &quot;&lt;path&gt;&quot;: [&lt;term&gt;(, &lt;term&gt;)*] // shorthand for &quot;? &lt;path&gt;&quot;: [&lt;term&gt;(, &lt;term&gt;)*]
    
}
</code></pre>
				<h2 id="property-paths">Property Paths</h2>
				<pre><code>&lt;path&gt; ::= (&lt;step&gt; ('/' &lt;step&gt;)*)?
         | (&lt;step&gt; ('.' &lt;step&gt;)*)?
         
&lt;step&gt; ::= &lt;&lt;iri&gt;&gt; | ^&lt;&lt;iri&gt;&gt; | &quot;&lt;alias&gt;&quot; # whitespace around steps ignored
</code></pre>
			</section>
			<footer>© 2020 Metreeca srl. This work is licensed under the
				<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons BY-NC-SA 4.0 License</a>
			</footer>
		</main>
		<script type="text/javascript" src="../index.js"></script>
	</body>
</html>