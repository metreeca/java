<!DOCTYPE html><html lang="en"><head><title>How To Secure Resources  |  Metreeca/Java</title><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="shortcut icon" href="../index.svg"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/themes/prism.min.css"><link rel="stylesheet" type="text/css" href="../index.css"><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script type="text/javascript" src="../index.js"></script></head><body><input id="toggle" type="checkbox"><nav><header><a href="https://www.metreeca.com/" title="Metreeca" style="background-image: url(../index.svg)"></a><span><a href="..">Metreeca/Java</a></span><label for="toggle"></label></header><section><a href="https://github.com/metreeca/java">v1.0.2</a><h1><a href="#sparql-endpoints">SPARQL Endpoints</a></h1></section></nav><main><header><a href="https://www.metreeca.com/" title="Metreeca" style="background-image: url(../index.svg)"></a><span><button title="Scroll to Top" onclick="document.querySelector('main').scrollTo(0, 0)">How To Secure Resources</button></span><label for="toggle"></label></header><section><h1 id="sparql-endpoints">SPARQL Endpoints</h1>
<pre><code class="language-shell">% curl --include localhost:8080/sparql \
	--header &quot;Authorization: Bearer 86fc8ad0-19a0-4df4-a3c9-819f04d671d4&quot; \
	--data-urlencode 'update=insert data { &lt;http://www.example.org/X&gt; &lt;http://www.example.org/Y&gt; &lt;http://www.example.org/Q&gt; .}'
</code></pre>
<pre><code class="language-java">
import com.metreeca.jse.JSEServer;
import com.metreeca.rdf4j.assets.Graph;

import org.eclipse.rdf4j.repository.sail.SailRepository;
import org.eclipse.rdf4j.sail.nativerdf.NativeStore;

import java.io.File;

import static com.metreeca.json.Values.uuid;
import static com.metreeca.rdf4j.assets.Graph.graph;
import static com.metreeca.rdf4j.handlers.Graphs.graphs;
import static com.metreeca.rdf4j.handlers.SPARQL.sparql;
import static com.metreeca.rest.Context.asset;
import static com.metreeca.rest.assets.Logger.logger;
import static com.metreeca.rest.assets.Vault.vault;
import static com.metreeca.rest.handlers.Router.router;
import static com.metreeca.rest.wrappers.Bearer.bearer;
import static com.metreeca.rest.wrappers.CORS.cors;
import static com.metreeca.rest.wrappers.Gateway.gateway;

import static java.lang.String.format;

public final class Sample {

	private static final File StoragePath=new File(&quot;target/data&quot;);

	private static final String UpdateRole=&quot;Update&quot;;
	private static final String UpdateKey=uuid();


	private static String key() {

		final String key=asset(vault()).get(&quot;UpdateKey&quot;).orElse(UpdateKey);

		asset(logger()).info(Sample.class, format(&quot;update key &lt;%s&gt;&quot;, UpdateKey));

		return key;
	}


	public static void main(final String... args) {
		new JSEServer()

				.delegate(context -&gt; context

						.set(graph(), () -&gt; new Graph(new SailRepository(new NativeStore(StoragePath))))

						.get(() -&gt; server()

								.with(cors())

								.with(bearer(key(), UpdateRole))

								.wrap(router()

										.path(&quot;/sparql&quot;, sparql()
												.query()
												.update(UpdateRole)
										)

										.path(&quot;/graphs&quot;, graphs()
												.query()
												.update(UpdateRole)
										)

								)
						)
				)

				.start();
	}

}
</code></pre>
</section><footer>Â© 2022 Metreeca srl. This work is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons BY-NC-SA 4.0 License</a></footer></main></body></html>