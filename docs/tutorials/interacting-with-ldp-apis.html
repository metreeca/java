<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  Copyright © 2013-2020 Metreeca srl. All rights reserved.

  This file is part of Metreeca/Link.

  Metreeca/Link is free software: you can redistribute it and/or modify it under the terms
  of the GNU Affero General Public License as published by the Free Software Foundation,
  either version 3 of the License, or(at your option) any later version.

  Metreeca/Link is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  See the GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License along with Metreeca/Link.
  If not, see <http://www.gnu.org/licenses/>.
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->

<!DOCTYPE html>
<html lang="en">
	<head><title>Interacting with Model‑Driven Linked Data REST APIs | Metreeca Linked Data Framework</title>
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<link rel="shortcut icon" href="../index.svg">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/themes/prism.min.css">
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/components/prism-core.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/plugins/autoloader/prism-autoloader.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../index.css">
	</head>
	<body><input id="toggle" type="checkbox">
		<nav>
			<header>
				<span><a href="https://www.metreeca.com/">metreeca</a><a href="../index.html">link<span>v0.53.0</span></a></span><label for="toggle"></label>
			</header>
			<section><a class="title" onclick="document.querySelector('main').scrollTo(0, 0)">Interacting with
				Model‑Driven Linked Data REST APIs</a><h1><a href="#model-driven-apis">Model-Driven APIs</a></h1><h1>
				<a href="#read-operations">Read Operations</a></h1><h2><a href="#rdf-resources">RDF Resources</a></h2>
				<h2><a href="#rdf-containers">RDF Containers</a></h2><h1><a href="#write-operations">Write Operations</a>
				</h1><h2><a href="#creating-resources">Creating Resources</a></h2><h2><a href="#updating-resources">Updating
					Resources</a></h2><h2><a href="#deleting-resources">Deleting Resources</a></h2><h1>
					<a href="#faceted-search">Faceted Search</a></h1><h2><a href="#sorting-and-pagination">Sorting and
					Pagination</a></h2><h2><a href="#facet-stats-and-options">Facet Stats and Options</a></h2></section>
		</nav>
		<main>
			<header>Interacting with Model‑Driven Linked Data REST APIs</header>
			<section><p>This example-driven tutorial introduces the main client-facing features of the Metreeca/Link
				model-driven linked data framework. Basic familiarity with
				<a href="https://www.w3.org/standards/semanticweb/data" target="_blank">linked data</a> concepts and
				<a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank">REST</a> APIs is
				required.</p>
				<p>In the following sections you will learn how to interact with REST APIs published with the framework,
					leveraging automatic model-driven fine-grained role‑based read/write access control, faceted search
					and incoming data validation.</p>
				<p>In the tutorial we will work with the linked data server developed in the
					<a href="publishing-ldp-apis">publishing tutorial</a>, using a semantic version of the
					<a href="http://www.eclipse.org/birt/phoenix/db/" target="_blank">BIRT</a> sample dataset,
					cross-linked to <a href="http://www.geonames.org/" target="_blank">GeoNames</a> entities for cities
					and countries. The BIRT sample is a typical business database, containing tables such as
					<em>offices</em>, <em>customers</em>, <em>products</em>, <em>orders</em>, <em>order lines</em>, … for
					<em>Classic Models</em>, a fictional world-wide retailer of scale toy models. Before moving on you
					may want to familiarize yourself with it walking through the
					<a href="https://metreeca.github.io/self/tutorials/search-and-analysis/" target="_blank">search and
						analysis tutorial</a> of the <a href="https://github.com/metreeca/self" target="_blank">Metreeca/Self</a>
					self-service linked data search and analysis tool, which works on the same data.</p>
				<p>We will walk through the REST API interaction process focusing on the task of consuming the
					<a href="https://demo.metreeca.com/apps/self/#endpoint=https://demo.metreeca.com/sparql&amp;collection=https://demo.metreeca.com/terms#Product" target="_blank">Product</a>
					catalog as a <a href="https://www.w3.org/TR/ldp-primer/" target="_blank">Linked Data Platform</a>
					(LDP) Basic Container.</p>
				<p>You may try out the examples using your favorite API testing tool or working from the command line
					with toos like <code>curl</code> or <code>wget</code>.</p>
				<p>A Maven project with the code for the complete demo app is available on
					<a href="https://github.com/metreeca/demo" target="_blank">GitHub</a>: clone or
					<a href="https://github.com/metreeca/demo/archive/master.zip" target="_blank">download</a> it to your
					workspace, open in your favorite IDE and launch a local instance of the server. If you are working
					with IntelliJ IDEA you may want to use the <code>Demo</code> pre-configured run configuration to
					deploy and update the local server instance.</p>
				<h1 id="model-driven-apis">Model-Driven APIs</h1>
				<p>The demo linked data server is pre-configured with a small collection of read/write REST APIs able to
					drive a typical web-based interface like a user-facing
					<a href="https://demo.metreeca.com/apps/shop/" target="_blank">product catalog</a>.</p>
				<p class="warning">The product catalog demo is hosted on a cloud service: it is not expected to provide
					production-level performance and may experience some delays during workspace initialization.</p>
				<table>
					<thead>
						<tr>
							<th align="left">REST API</th>
							<th align="left">Contents</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td align="left"><a href="https://demo.metreeca.com/product-lines/" target="_blank">/product-lines/</a>
							</td>
							<td align="left">Product line faceted catalog</td>
						</tr>
						<tr>
							<td align="left">
								<a href="https://demo.metreeca.com/product-lines/classic-cars" target="_blank">/product-lines/*</a>
							</td>
							<td align="left">Product line details</td>
						</tr>
						<tr>
							<td align="left"><a href="https://demo.metreeca.com/products/" target="_blank">/products/</a>
							</td>
							<td align="left">Product faceted catalog</td>
						</tr>
						<tr>
							<td align="left"><a href="https://demo.metreeca.com/products/S18_3140" target="_blank">/products/*</a>
							</td>
							<td align="left">Product sheets</td>
						</tr>
					</tbody>
				</table>
				<p>Even a simple application like this would usually require extensive back-end development activities in
					order to connect to the database and perform coordinated custom queries supporting data retrieval,
					faceted search, facet population, sorting, pagination and so on. User authorization, validation of
					updates and enforcing of consistency rules would as well require lenghty and error-prone custom
					back-end development.</p>
				<p>Metreeca/Link automates the whole process with a model-driven API engine that compiles high‑level
					declarative linked data models into read/write REST APIs immediately available for front-end app
					development, supporting all of the above-mentioned features without custom back-end coding.</p>
				<p>You may learn how to publish your own model-driven linked data APIs walking through the
					<a href="publishing-ldp-apis">linked data publishing tutorial</a>.</p>
				<h1 id="read-operations">Read Operations</h1>
				<p>Linked data REST APIs published by Metreeca/Link API engine support controlled read access to RDF
					contents managed by the underlying graph storage layer.</p>
				<p>User authorization and user-specific content generation are performed according to
					<a href="../references/spec-language#parameters">role‑based</a> rules integrated in the linked data
					model driving the API publishing process.</p>
				<h2 id="rdf-resources">RDF Resources</h2>
				<p>RDF resources managed by the underlying graph storage are exposed by the Metreeca REST API engine as
					<a href="https://www.w3.org/TR/ldp/#ldprs" target="_blank">Linked Data Platform (LDP) RDF Sources</a>.
				</p>
				<p>To retrieve the RDF description of a published resource, as specified by the associated data model,
					just perform a <code>GET</code> operation on the URL identifying the resource.</p>
				<pre><code class="language-sh">% curl --include &quot;http://localhost:8080/products/S18_3140&quot;

HTTP/1.1 200 
Vary: Accept
Link: &lt;http://www.w3.org/ns/ldp#Resource&gt;; rel=&quot;type&quot;
Link: &lt;http://www.w3.org/ns/ldp#RDFSource&gt;; rel=&quot;type&quot;
Link: &lt;http://localhost:8080/products/S18_3140?specs&gt;;
		rel=http://www.w3.org/ns/ldp#constrainedBy
Content-Type: text/turtle;charset=UTF-8


@base &lt;http://localhost:8080/products/S18_3140&gt; .

&lt;&gt; a &lt;/terms#Product&gt;;
  &lt;/terms#code&gt; &quot;S18_3140&quot;;
  &lt;/terms#line&gt; &lt;/product-lines/vintage-cars&gt;;
  &lt;/terms#scale&gt; &quot;1:18&quot;;
  &lt;/terms#sell&gt; 136.59;
  &lt;/terms#stock&gt; 3913;
  &lt;/terms#vendor&gt; &quot;Unimax Art Galleries&quot;;
  &lt;http://www.w3.org/2000/01/rdf-schema#comment&gt; &quot;Features opening trunk,…&quot;;
  &lt;http://www.w3.org/2000/01/rdf-schema#label&gt; &quot;1903 Ford Model A&quot; .

&lt;/product-lines/vintage-cars&gt; &lt;http://www.w3.org/2000/01/rdf-schema#label&gt; &quot;Vintage Cars&quot; .
</code></pre>
				<p>Standard content negotiation is supported, so you may ask for resource descriptions in a suitable RDF
					concrete syntax (<a href="https://www.w3.org/TR/turtle/" target="_blank">Turtle</a>,
					<a href="https://www.w3.org/TR/n-triples/" target="_blank">N-Triples</a>,
					<a href="https://www.w3.org/TR/rdf-syntax-grammar/" target="_blank">RDF/XML</a>, …) specifying the
					associated MIME type in the <code>Accept</code> HTTP request header.</p>
				<pre><code class="language-sh">% curl --include --header 'Accept: application/rdf+xml' \
    &quot;http://localhost:8080/products/S18_3140&quot;

HTTP/1.1 200 
Vary: Accept
Link: &lt;http://www.w3.org/ns/ldp#Resource&gt;; rel=&quot;type&quot;
Link: &lt;http://www.w3.org/ns/ldp#RDFSource&gt;; rel=&quot;type&quot;
Link: &lt;http://localhost:8080/products/S18_3140?specs&gt;;
		rel=http://www.w3.org/ns/ldp#constrainedBy
Content-Type: application/rdf+xml

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;rdf:RDF
        xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;
        xml:base=&quot;http://localhost:8080/products/S18_3140&quot;&gt;

&lt;rdf:Description rdf:about=&quot;&quot;&gt;
        &lt;rdf:type rdf:resource=&quot;/terms#Product&quot;/&gt;
        &lt;label xmlns=&quot;http://www.w3.org/2000/01/rdf-schema#&quot;&gt;1903 Ford Model A&lt;/label&gt;
        &lt;comment xmlns=&quot;http://www.w3.org/2000/01/rdf-schema#&quot;&gt;Features opening trunk, …&lt;/comment&gt;
        &lt;code xmlns=&quot;http://localhost:8080/terms#&quot;&gt;S18_3140&lt;/code&gt;
        &lt;line xmlns=&quot;http://localhost:8080/terms#&quot; rdf:resource=&quot;/product-lines/vintage-cars&quot;/&gt;
&lt;/rdf:Description&gt;

&lt;rdf:Description rdf:about=&quot;/product-lines/vintage-cars&quot;&gt;
        &lt;label xmlns=&quot;http://www.w3.org/2000/01/rdf-schema#&quot;&gt;Vintage Cars&lt;/label&gt;
&lt;/rdf:Description&gt;

&lt;rdf:Description rdf:about=&quot;&quot;&gt;
        &lt;scale xmlns=&quot;http://localhost:8080/terms#&quot;&gt;1:18&lt;/scale&gt;
        &lt;vendor xmlns=&quot;http://localhost:8080/terms#&quot;&gt;Unimax Art Galleries&lt;/vendor&gt;
        &lt;stock xmlns=&quot;http://localhost:8080/terms#&quot; rdf:datatype=&quot;http://www.w3.org/2001/XMLSchema#integer&quot;&gt;3913&lt;/stock&gt;
        &lt;sell xmlns=&quot;http://localhost:8080/terms#&quot; rdf:datatype=&quot;http://www.w3.org/2001/XMLSchema#decimal&quot;&gt;136.59&lt;/sell&gt;
&lt;/rdf:Description&gt;

&lt;/rdf:RDF&gt;
</code></pre>
				<p>JSON-based formats are especially convenient for front-end development: beside the standardised
					<a href="https://www.w3.org/TR/json-ld/" target="_blank">JSON-LD</a> RDF serialisation, Metreeca
					supports a simpler <a href="../references/idiomatic-json">idiomatic</a> JSON-based format, which
					streamlines resource descriptions taking into account the constraints described in the associated
					linked data models.</p>
				<p>To ask for resource descriptions in the idiomatic JSON format, specify the
					<code>application/json</code> MIME type in the <code>Accept</code> HTTP request header.</p>
				<pre><code class="language-sh">% curl --include --header 'Accept: application/json' \
    &quot;http://localhost:8080/products/S18_3140&quot;
    
HTTP/1.1 200 
Vary: Accept
Link: &lt;http://www.w3.org/ns/ldp#Resource&gt;; rel=&quot;type&quot;
Link: &lt;http://www.w3.org/ns/ldp#RDFSource&gt;; rel=&quot;type&quot;
Link: &lt;http://localhost:8080/products/S18_3140?specs&gt;;
		rel=http://www.w3.org/ns/ldp#constrainedBy
Content-Type: application/json;charset=UTF-8

{
    &quot;id&quot;: &quot;/products/S18_3140&quot;,
    &quot;type&quot;: &quot;/terms#Product&quot;,
    &quot;label&quot;: &quot;1903 Ford Model A&quot;,
    &quot;comment&quot;: &quot;Features opening trunk,  working steering system&quot;,
    &quot;code&quot;: &quot;S18_3140&quot;,
    &quot;line&quot;: {
        &quot;id&quot;: &quot;/product-lines/vintage-cars&quot;,
        &quot;label&quot;: &quot;Vintage Cars&quot;
    },
    &quot;scale&quot;: &quot;1:18&quot;,
    &quot;vendor&quot;: &quot;Unimax Art Galleries&quot;,
    &quot;stock&quot;: 3913,
    &quot;price&quot;: 136.59
}
</code></pre>
				<p>If available, the linked data model associated with a resource can be
					<a href="../references/spec-language.html#rdf-encoding">retrieved and inspected</a> from the URL
					provided in the <code>Link rel=&quot;ldp:constrainedBy&quot;</code>HTTP response header. The
					information provided by the associated model could be used, for instance, to optimize or dynamically
					build user interfaces or to automaticaly provide client-side validation on data forms.</p>
				<p>Retrieved data is automatically trimmed to the allowed envelope specified in the linked data model
					driving the target REST API for the <a href="../javadocs/com/metreeca/rest/Request.html#roles--">roles</a>
					enabled for the current request user. Reserved properties are included only if the request is
					properly authenticated.</p>
				<pre><code class="language-sh">% curl --include --header 'Accept: application/json' \
	--header 'Authorization: Bearer secret' \
    &quot;http://localhost:8080/products/S18_3140&quot;
    
HTTP/1.1 200  
Content-Type: application/json;charset=UTF-8

{
    &quot;id&quot;: &quot;/products/S18_3140&quot;,
    
    ⋮
    
    &quot;stock&quot;: 3913,
    &quot;price&quot;: 136.59,
    &quot;buy&quot;: 68.3 # &lt;&lt; buy price included only if authorized
}
</code></pre>
				<h2 id="rdf-containers">RDF Containers</h2>
				<p>RDF resource collections managed by the underlying graph storage are exposed by the Metreeca/Link REST
					API engine as <a href="https://www.w3.org/TR/ldp/#ldpc" target="_blank">Linked Data Platform (LDP)
						Containers</a>.</p>
				<p>To retrieve the RDF description of a published collections, as specified by the associated data model,
					perform a <code>GET</code> operation on the URL identifying the collection.</p>
				<pre><code class="language-sh">% curl --include --header 'Accept: application/json' \
    &quot;http://localhost:8080/products/&quot;
    
HTTP/1.1 200 
Vary: Accept
Vary: Prefer
Link: &lt;http://www.w3.org/ns/ldp#Resource&gt;; rel=&quot;type&quot;
Link: &lt;http://www.w3.org/ns/ldp#RDFSource&gt;; rel=&quot;type&quot;
Link: &lt;http://www.w3.org/ns/ldp#Container&gt;; rel=&quot;type&quot;
Link: &lt;http://localhost:8080/products/?specs&gt;;
		rel=http://www.w3.org/ns/ldp#constrainedBy
Content-Type: application/json;charset=UTF-8

{
    &quot;id&quot;: &quot;/products/&quot;,
    &quot;contains&quot;: [
        {
            &quot;id&quot;: &quot;/products/S10_1678&quot;,
            &quot;type&quot;: &quot;/terms#Product&quot;,
            &quot;label&quot;: &quot;1969 Harley Davidson Ultimate Chopper&quot;,
            &quot;comment&quot;: &quot;This replica features working kickstand, front suspension,…&quot;,
            &quot;code&quot;: &quot;S10_1678&quot;,
            &quot;line&quot;: {
                &quot;id&quot;: &quot;/product-lines/motorcycles&quot;,
                &quot;label&quot;: &quot;Motorcycles&quot;
            },
            &quot;scale&quot;: &quot;1:10&quot;,
            &quot;vendor&quot;: &quot;Min Lin Diecast&quot;,
            &quot;stock&quot;: 7933,
            &quot;price&quot;: 95.7
        },

		⋮
		
	]
}
</code></pre>
				<p>By default, container descriptions include a digest description of each container item, but a concise
					description of the container itself may be retrieved using the standard LDP <code>Prefer</code> HTTP
					request header.</p>
				<pre><code class="language-sh">% curl --include --header 'Accept: application/json' \
    --header 'Prefer: return=representation; include=&quot;http://www.w3.org/ns/ldp#PreferMinimalContainer&quot;' \
    &quot;http://localhost:8080/products/&quot;
    
HTTP/1.1 200 
Vary: Accept
Vary: Prefer
Link: &lt;http://www.w3.org/ns/ldp#Resource&gt;; rel=&quot;type&quot;
Link: &lt;http://www.w3.org/ns/ldp#RDFSource&gt;; rel=&quot;type&quot;
Link: &lt;http://www.w3.org/ns/ldp#Container&gt;; rel=&quot;type&quot;
Link: &lt;http://localhost:8080/products/?specs&gt;;
		rel=http://www.w3.org/ns/ldp#constrainedBy
Preference-Applied: return=representation;
		include=&quot;http://www.w3.org/ns/ldp#PreferMinimalContainer&quot;
Content-Type: application/json;charset=UTF-8

{
    &quot;id&quot;: &quot;/products/&quot;,
}
</code></pre>
				<p>Again, if available, the linked data model associated with a collection can be retrieved and inspected
					from the URL provided in the <code>Link rel=&quot;ldp:constrainedBy&quot;</code> HTTP response
					header.</p>
				<h1 id="write-operations">Write Operations</h1>
				<p>Linked data REST APIs published by Metreeca/Link API engine support controlled write access to RDF
					contents managed by the underlying graph storage layer.</p>
				<p>User authorization and user-specific content validation are performed according to
					<a href="../references/spec-language#parameters">role‑based</a> rules integrated in the linked data
					model driving the API publishing process.</p>
				<h2 id="creating-resources">Creating Resources</h2>
				<p>New RDF resources are created by submitting an RDF description to the REST API of a writable RDF
					collection using the <code>POST</code> HTTP method.</p>
				<p>Standard content negotiation is supported, so you may submit resource descriptions in a suitable RDF
					concrete syntax (<a href="https://www.w3.org/TR/turtle/" target="_blank">Turtle</a>,
					<a href="https://www.w3.org/TR/n-triples/" target="_blank">N-Triples</a>,
					<a href="https://www.w3.org/TR/rdf-syntax-grammar/" target="_blank">RDF/XML</a>, …) specifying the
					associated MIME type in the <code>Content-Type</code> HTTP request header.</p>
				<p>Note that property values that may be inferred from the associated linked data model, like <code>rdf:type</code>,
					may be safely omitted.</p>
				<pre><code class="language-sh">% curl --include --request POST \
    --header 'Authorization: Bearer secret' \
		--header 'Content-Type: text/turtle' \
    &quot;http://localhost:8080/products/&quot; \
    --data @- &lt;&lt;EOF
    
@prefix demo: &lt;http://localhost:8080/terms#&gt;.
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;.

&lt;&gt;
		rdf:type &lt;/terms#Product&gt;;
    rdfs:label &quot;Piaggio Vespa&quot;;
    rdfs:comment &quot;The iconic Piaggio's scooter…&quot;;
    demo:scale &quot;1:10&quot;;
    demo:vendor &quot;Autoart Studio Design&quot;;
    demo:buy 101.0;
    demo:sell 123.0;
    demo:line &lt;/product-lines/motorcycles&gt;.
EOF

HTTP/2 201 Created
Location: http://localhost:8080/products/S10_6
</code></pre>
				<p>The newly created resource is immediately available for retrieval at the URL returned in the <code>Location</code>
					HTTP response header.</p>
				<p>The idiomatic model-driven JSON format is supported also for write operations, specifying the <code>application/json</code>
					MIME type in the <code>Content-Type</code> HTTP request header.</p>
				<p>Note that the <code>line</code> property is included in a shorthand form, as it is inferred to be a
					resource IRI from the associated linked data model.</p>
				<pre><code class="language-sh">% curl --include --request POST \
    --header 'Authorization: Bearer secret' \
    --header 'Content-Type: application/json' \
    &quot;http://localhost:8080/products/&quot; \
    --data @- &lt;&lt;EOF
{
		&quot;type&quot;: &quot;/terms#Product&quot;,
    &quot;label&quot;: &quot;Piaggio Ciao&quot;,
    &quot;comment&quot; : &quot;The sturdy Piaggio's velo bike…&quot;,
    &quot;scale&quot;: &quot;1:10&quot;,
    &quot;vendor&quot;: &quot;Autoart Studio Design&quot;,
    &quot;buy&quot;: 87.0,
    &quot;price&quot;: 99.0,
    &quot;line&quot;: &quot;/product-lines/motorcycles&quot; 
}
EOF

HTTP/2 201 Created
Location: https://demo.metreeca.com/products/S10_7
</code></pre>
				<p>Submitted data is automatically validated against the constraints specified in the linked data model
					driving the target REST API. Submiting, for instance, out of range price data would return an error
					and a structured error report.</p>
				<pre><code class="language-sh">% curl --include --request POST \
    --header 'Authorization: Bearer secret' \
    --header 'Content-Type: text/turtle' \
    &quot;http://localhost:8080/products/&quot; \
    --data @- &lt;&lt;EOF
    
@prefix demo: &lt;http://localhost:8080/terms#&gt;.
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;.

&lt;&gt;
  	rdf:type &lt;/terms#Product&gt;;
		rdfs:label &quot;Piaggio Vespa&quot;;
    rdfs:comment &quot;The iconic Piaggio's scooter…&quot;;
    demo:scale &quot;1:10&quot;;
    demo:vendor &quot;Autoart Studio Design&quot;;
    demo:buy -101.0;
    demo:sell 9999.0;
    demo:line &lt;http://localhost:8080/product-lines/motorcycles&gt;.
    
EOF

HTTP/1.1 422 Unprocessable Entity
Location: http://localhost:8080/products/
Content-Type: application/json;charset=UTF-8

{
    &quot;error&quot;: &quot;data-invalid&quot;,
    &quot;trace&quot;: {
        &quot;https://demo.metreeca.com/terms#buy&quot;: {
            &quot;&quot;: {
                &quot;minInclusive(\&quot;0.0\&quot;^^&lt;http://www.w3.org/2001/XMLSchema#decimal&gt;)&quot;: [
                    &quot;\&quot;-101.0\&quot;^^&lt;http://www.w3.org/2001/XMLSchema#decimal&gt;&quot;
                ]
            }
        },
        &quot;https://demo.metreeca.com/terms#sell&quot;: {
            &quot;&quot;: {
                &quot;maxExclusive(\&quot;1000.0\&quot;^^&lt;http://www.w3.org/2001/XMLSchema#decimal&gt;)&quot;: [
                    &quot;\&quot;9999.0\&quot;^^&lt;http://www.w3.org/2001/XMLSchema#decimal&gt;&quot;
                ]
            }
        }
    }
}
</code></pre>
				<p>Submitted data is automatically matched against the allowed envelope specified in the linked data
					model driving the target REST API for the
					<a href="../javadocs/com/metreeca/rest/Request.html#roles--">roles</a> enabled for the current
					request user. Submiting, for instance, buy price data without valid authorization headers would
					return an error.</p>
				<pre><code class="language-sh">% curl --include --request POST \
    --header 'Content-Type: application/json' \
    &quot;http://localhost:8080/products/&quot; \
    --data @- &lt;&lt;EOF
{
    &quot;label&quot;: &quot;Piaggio Ciao&quot;,
    &quot;comment&quot; : &quot;The sturdy Piaggio's velo bike…&quot;,
    &quot;scale&quot;: &quot;1:10&quot;,
    &quot;vendor&quot;: &quot;Autoart Studio Design&quot;,
    &quot;buy&quot;: 87.0,
    &quot;price&quot;: 99.0,
    &quot;line&quot;: &quot;/product-lines/motorcycles&quot; 
}
EOF

HTTP/1.1 401 Unauthorized
</code></pre>
				<h2 id="updating-resources">Updating Resources</h2>
				<p>Existing writable RDF resources are updated by submitting an RDF description to their REST API using
					the <code>PUT</code> HTTP method.</p>
				<p>Standard content negotiation is as usual supported through the <code>Content-Type</code> HTTP request
					header, also for the idiomatic JSON format.</p>
				<p>Note that server-managed properties like <code>demo:code</code> and <code>demo:stock</code> are
					omitted, as they are inherited from the existing description.</p>
				<pre><code class="language-sh">% curl --include --request PUT \
    --header 'Authorization: Bearer secret' \
    --header 'Content-Type: application/json' \
    &quot;http://localhost:8080/products/S18_3140&quot; \
    --data @- &lt;&lt;EOF
{
   	&quot;type&quot;: &quot;/terms#Product&quot;,
    &quot;label&quot;: &quot;1903 Ford Model A&quot;,
    &quot;comment&quot;: &quot;Features opening trunk, working steering system&quot;,
    &quot;line&quot;: &quot;/product-lines/vintage-cars&quot;,
    &quot;scale&quot;: &quot;1:18&quot;,
    &quot;vendor&quot;: &quot;Unimax Art Galleries&quot;,
    &quot;buy&quot;: 50.00,
    &quot;price&quot;: 120.00
}
EOF

HTTP/2 204 No Content
</code></pre>
				<p>The updated resource is immediately available for retrieval at the existing URL.</p>
				<p>As in the case of resource creation, submitted data is automatically validated against constraints and
					roles specified in the linked data model driving the target REST API.</p>
				<h2 id="deleting-resources">Deleting Resources</h2>
				<p>Existing writable RDF resources are deleted using the <code>DELETE</code> HTTP method on their REST
					API.</p>
				<pre><code class="language-sh">% curl --include --request DELETE \
	--header 'Authorization: Bearer secret' \
	&quot;http://localhost:8080/products/S18_3140&quot;

HTTP/2 204 No Content
</code></pre>
				<p>The deleted resource is immediately no longer available for retrieval at the previous URL.</p>
				<h1 id="faceted-search">Faceted Search</h1>
				<p>Metreeca/Link REST APIs engine extends <a href="https://www.w3.org/TR/ldp/#ldpc" target="_blank">Linked
					Data Platform (LDP) Containers</a> with faceted search and supporting facet-related queries.</p>
				<p>To retrieve a digest description of collection items matching a set of facet filters, perform a <code>GET</code>
					operation on the URL identifying the collection, appending a URL-encoded JSON query object
					<a href="../references/faceted-search">describing the filters</a> to be applied.</p>
				<pre><code class="language-json">{
  &quot;&gt;= price&quot; : 100, 
  &quot;vendor&quot;: &quot;Classic Metal Creations&quot;
}
</code></pre>
				<pre><code class="language-sh">% curl --include --header 'Accept: application/json' \
    'http://localhost:8080/products/?%3E%3D+price=100&amp;vendor=Classic+Metal+Creations'
    
HTTP/1.1 200 
Content-Type: application/json;charset=UTF-8

{
    &quot;id&quot;: &quot;/products/&quot;,
    &quot;contains&quot;: [
        {
            &quot;id&quot;: &quot;/products/S10_1949&quot;,
            &quot;type&quot;: &quot;/terms#Product&quot;,
            &quot;label&quot;: &quot;1952 Alpine Renault 1300&quot;,
            &quot;comment&quot;: &quot;Turnable front wheels; steering function; detailed interior; …&quot;,
            &quot;code&quot;: &quot;S10_1949&quot;,
            &quot;line&quot;: {
                &quot;id&quot;: &quot;/product-lines/classic-cars&quot;,
                &quot;label&quot;: &quot;Classic Cars&quot;
            },
            &quot;scale&quot;: &quot;1:10&quot;,
            &quot;vendor&quot;: &quot;Classic Metal Creations&quot;,
            &quot;stock&quot;: 7305,
            &quot;price&quot;: 214.3
        },
      
      ⋮
      
    ]
}
</code></pre>
				<p>Note that RDF container descriptions are omitted from faceted search results.</p>
				<h2 id="sorting-and-pagination">Sorting and Pagination</h2>
				<p>Faceted search results may be sorted and paginated including
					<a href="../references/faceted-search#edges-query">sorting criteria</a> and
					<a href="../references/faceted-search#edges-query">pagination limits</a> in the JSON query object.
				</p>
				<pre><code class="language-json">{
  
  &quot;&gt;= price&quot; : 100, 
  &quot;vendor&quot;: &quot;Classic Metal Creations&quot;,

  &quot;_order&quot;:&quot;-price&quot;,
  &quot;_offset&quot;:0,
  &quot;_limit&quot;:10
  
}
</code></pre>
				<h2 id="facet-stats-and-options">Facet Stats and Options</h2>
				<p>The faceted search engine supports also introspection queries for retrieving
					<a href="../references/faceted-search#stats-query">facet stats</a> and available
					<a href="../references/faceted-search#items-query">facet options</a>.</p>
				<p>To retrieve datatype, count and range stats for a facet, taking into account applied filters, specify
					the target property path in the faceted search query object.</p>
				<pre><code class="language-json">{
  
  &quot;&gt;= price&quot; : 100, 
  &quot;vendor&quot;: &quot;Classic Metal Creations&quot;,

	&quot;_stats&quot;: &quot;price&quot;
  
}
</code></pre>
				<pre><code class="language-sh">% curl --include --header 'Accept: application/json' \
    'http://localhost:8080/products/?%3E%3D+price=100&amp;vendor=Classic+Metal+Creations&amp;_stats=price'

HTTP/2 200 OK
Content-Type: application/json

{
    &quot;id&quot;: &quot;/products&quot;,
    &quot;count&quot;: 10,
    &quot;min&quot;: 44.8,
    &quot;max&quot;: 214.3,
    &quot;stats&quot;: [
        {
            &quot;id&quot;: &quot;http://www.w3.org/2001/XMLSchema#decimal&quot;,
            &quot;count&quot;: 10,
            &quot;min&quot;: 44.8,
            &quot;max&quot;: 214.3
        }
    ]
}
</code></pre>
				<p>To list available options and counts for a facet, taking into account applied filters, specify the
					target property path in the faceted search query object.</p>
				<pre><code class="language-json">{
  
  &quot;&gt;= price&quot; : 100, 
  &quot;vendor&quot;: &quot;Classic Metal Creations&quot;,

	&quot;_terms&quot;: &quot;line&quot;
  
}
</code></pre>
				<pre><code class="language-sh">% curl --include --header 'Accept: application/json' \
    'http://localhost:8080/products/?%3E%3D+price=100&amp;vendor=Classic+Metal+Creations&amp;_terms=line'

HTTP/2 200 OK
Content-Type: application/json

{
    &quot;id&quot;: &quot;/products/&quot;,
    &quot;terms&quot;: [
        {
            &quot;value&quot;: {
                &quot;id&quot;: &quot;/product-lines/classic-cars&quot;,
                &quot;label&quot;: &quot;Classic Cars&quot;
            },
            &quot;count&quot;: 4
        },
        {
            &quot;value&quot;: {
                &quot;id&quot;: &quot;/product-lines/planes&quot;,
                &quot;label&quot;: &quot;Planes&quot;
            },
            &quot;count&quot;: 1
        }
    ]
}
</code></pre>
				<p>Labels and comments for the selected options are also retrieved to support facet visualization.</p>
			</section>
			<footer>© 2020 Metreeca srl. This work is licensed under the
				<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons BY-NC-SA 4.0 License</a>
			</footer>
		</main>
		<script type="text/javascript" src="../index.js"></script>
	</body>
</html>